<!DOCTYPE HTML>
<!--
DeepLearning.scala by ThoughtWorks
Released for free under the Apache 2.0 license (https://github.com/ThoughtWorksInc/DeepLearning.scala/blob/1.0.x/LICENSE)
-->
<html>
<head>
	<title>DeepLearning.scala by ThoughtWorks</title>
	<meta http-equiv="content-type" content="text/html; charset=utf-8" />
	<meta name="description" content="DeepLearning.Scala" />
	<meta name="keywords" content="DeepLearning,Scala" />
	<link href='https://fonts.googleapis.com/css?family=Roboto:400,100,300,700,500,900' rel='stylesheet' type='text/css'>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js" type="text/javascript"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js" type="text/javascript"></script>
	<script src="/assets/js/skel.min.js"> </script>
	<script src="/assets/js/skel-panels.min.js"></script>
	<script src="/assets/js/init.js"> </script>
	<script>
		init_init("/assets/css/style");
	</script>
	<noscript>
		<link rel="stylesheet" href="/assets/css/skel-noscript.css" />
		<link rel="stylesheet" href="/assets/css/style.css" />
		<link rel="stylesheet" href="/assets/css/style-desktop.css" />
	</noscript>
	<style>
		
	</style>
	<script>
	  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

	  ga('create', 'UA-103605110-1', 'auto');
	  ga('send', 'pageview');
	</script>
</head>
<body >
	<!-- Header -->
	<div id="header">
		<div id="nav-wrapper"><div class="container">
	<!-- Nav -->
	<nav id="nav">
		<ul>
			
			<li >
				<a href="/index.html">
					<img alt="DeepLearning.scala"
					     src="/assets/images/logo-text-white-opacity.png"
					     style="height: 1.5em; vertical-align: text-bottom;">
				</a>
			</li>
			<li ><a href="/plugins">Plugins</a></li>
			<li ><a href="/doc">Documentation</a></li>
			<li ><a href="/news">News</a></li>
			<li ><a href="/get-involved">Get Involved</a></li>
		</ul>
	</nav>
</div></div>

		<div class="container">

			<!-- Logo -->
			<div id="logo">
				<h1><a><img width="65%" alt="DeepLearning.scala" src="/assets/images/logo-text-white-opacity.png"/></a></h1>
				<span class="tag">By ThoughtWorks</span>
			</div>
		</div>
	</div>
	<!-- Header -->
	<div id="main">
    <div class="container">
        <div class="row">
            <div class="col-md-3">
                <nav class="toc" role="navigation">
                    
<ul class="default">
    
    <li>
        <a href="/doc/">
            
            
            Introduction
            
        </a>
    </li>
    
    
<ul class="default">
    
    <li>
        <a href="/demo/GettingStarted.html">
            
            
            GettingStarted
            
        </a>
    </li>
    
    
    <li>
        <a href="/demo/SoftmaxLinearClassifier.html">
            
            
            SoftmaxLinearClassifier
            
        </a>
    </li>
    
    
    <li>
        <a href="/demo/CharRNN.html">
            
            
            CharRNN
            
        </a>
    </li>
    
    
    <li>
        <a href="/demo/ContributorGuide.html">
            
            
            ContributorGuide
            
        </a>
    </li>
    
    
    <li>
        <a href="/demo/CNN.html">
            
            
            Convolutional Neural Network
            
        </a>
    </li>
    
    
</ul>

    
    
</ul>

                </nav>
            </div>
            <div id="content" class="8u skel-cell-important">
                <section>
                    <div class="col-md-9 normal-head">
                        
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-scala"><pre><span></span><span class="k">import</span> <span class="nn">$ivy.</span><span class="n">`org.nd4j::nd4s:0.8.0`</span>
<span class="k">import</span> <span class="nn">$ivy.</span><span class="n">`org.nd4j:nd4j-native-platform:0.8.0`</span>
<span class="k">import</span> <span class="nn">$ivy.</span><span class="n">`com.thoughtworks.deeplearning::plugins-builtins:2.0.2`</span>

<span class="k">import</span> <span class="nn">org.nd4j.linalg.api.ndarray.INDArray</span>
<span class="k">import</span> <span class="nn">org.nd4j.linalg.factory.Nd4j</span>
<span class="k">import</span> <span class="nn">com.thoughtworks.deeplearning.plugins.Builtins</span>
<span class="k">import</span> <span class="nn">com.thoughtworks.deeplearning.DeepLearning</span>
<span class="k">import</span> <span class="nn">com.thoughtworks.feature.Factory</span>
<span class="k">import</span> <span class="nn">scala.concurrent.ExecutionContext.Implicits.global</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[1]:</div>




<div class="output_text output_subarea output_execute_result">
<pre><span class="ansi-green-fg">import </span><span class="ansi-cyan-fg">$ivy.$                     
</span>
<span class="ansi-green-fg">import </span><span class="ansi-cyan-fg">$ivy.$                                    
</span>
<span class="ansi-green-fg">import </span><span class="ansi-cyan-fg">$ivy.$                                                      

</span>
<span class="ansi-green-fg">import </span><span class="ansi-cyan-fg">org.nd4j.linalg.api.ndarray.INDArray
</span>
<span class="ansi-green-fg">import </span><span class="ansi-cyan-fg">org.nd4j.linalg.factory.Nd4j
</span>
<span class="ansi-green-fg">import </span><span class="ansi-cyan-fg">com.thoughtworks.deeplearning.plugins.Builtins
</span>
<span class="ansi-green-fg">import </span><span class="ansi-cyan-fg">com.thoughtworks.deeplearning.DeepLearning
</span>
<span class="ansi-green-fg">import </span><span class="ansi-cyan-fg">com.thoughtworks.feature.Factory
</span>
<span class="ansi-green-fg">import </span><span class="ansi-cyan-fg">scala.concurrent.ExecutionContext.Implicits.global</span></pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-scala"><pre><span></span><span class="n">interp</span><span class="o">.</span><span class="n">load</span><span class="o">(</span><span class="n">scala</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="nc">Source</span><span class="o">.</span><span class="n">fromURL</span><span class="o">(</span><span class="k">new</span> <span class="n">java</span><span class="o">.</span><span class="n">net</span><span class="o">.</span><span class="nc">URL</span><span class="o">(</span><span class="s">&quot;https://gist.github.com/Atry/1fb0608c655e3233e68b27ba99515f16/raw/39ba06ee597839d618f2fcfe9526744c60f2f70a/FixedLearningRate.sc&quot;</span><span class="o">)).</span><span class="n">mkString</span><span class="o">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-scala"><pre><span></span><span class="n">interp</span><span class="o">.</span><span class="n">load</span><span class="o">(</span><span class="s">&quot;&quot;&quot;</span>
<span class="s">val hyperparameters1 = Factory[Builtins with FixedLearningRate].newInstance(learningRate = 0.01)</span>
<span class="s">&quot;&quot;&quot;</span><span class="o">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-scala"><pre><span></span><span class="k">import</span> <span class="nn">hyperparameters1.</span><span class="o">{</span><span class="nc">INDArrayLayer</span><span class="o">,</span> <span class="nc">INDArrayWeight</span><span class="o">}</span>

<span class="k">val</span> <span class="n">weight1</span> <span class="k">=</span> <span class="o">{</span>
  <span class="nc">INDArrayWeight</span><span class="o">(</span><span class="nc">Nd4j</span><span class="o">.</span><span class="n">randn</span><span class="o">(</span><span class="mi">10</span><span class="o">,</span> <span class="mi">10</span><span class="o">))</span>
<span class="o">}</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stderr output_text">
<pre>SLF4J: Failed to load class &#34;org.slf4j.impl.StaticLoggerBinder&#34;.
SLF4J: Defaulting to no-operation (NOP) logger implementation
SLF4J: See http://www.slf4j.org/codes.html#StaticLoggerBinder for further details.
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt output_prompt">Out[6]:</div>




<div class="output_text output_subarea output_execute_result">
<pre><span class="ansi-green-fg">import </span><span class="ansi-cyan-fg">hyperparameters1.{INDArrayLayer, INDArrayWeight}

</span>
<span class="ansi-cyan-fg">weight1</span>: <span class="ansi-green-fg">Object</span> with <span class="ansi-green-fg">hyperparameters1</span>.<span class="ansi-green-fg">INDArrayWeightApi</span> with <span class="ansi-green-fg">hyperparameters1</span>.<span class="ansi-green-fg">WeightApi</span> with <span class="ansi-green-fg">hyperparameters1</span>.<span class="ansi-green-fg">WeightApi</span> = Weight[fullName=$sess.cmd5Wrapper.Helper.weight1]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-scala"><pre><span></span><span class="k">def</span> <span class="n">layer1</span><span class="o">(</span><span class="n">input</span><span class="k">:</span> <span class="kt">INDArrayLayer</span><span class="o">)</span><span class="k">:</span> <span class="kt">INDArrayLayer</span> <span class="o">=</span> <span class="o">{</span>
  <span class="k">import</span> <span class="nn">hyperparameters1.implicits._</span>
  <span class="k">import</span> <span class="nn">hyperparameters1.max</span>
  <span class="n">max</span><span class="o">(</span><span class="n">input</span><span class="o">.</span><span class="n">dot</span><span class="o">(</span><span class="n">weight1</span><span class="o">),</span> <span class="mf">0.0</span><span class="o">)</span>
<span class="o">}</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[7]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>defined <span class="ansi-green-fg">function</span> <span class="ansi-cyan-fg">layer1</span></pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-scala"><pre><span></span><span class="n">interp</span><span class="o">.</span><span class="n">load</span><span class="o">(</span><span class="n">scala</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="nc">Source</span><span class="o">.</span><span class="n">fromURL</span><span class="o">(</span><span class="k">new</span> <span class="n">java</span><span class="o">.</span><span class="n">net</span><span class="o">.</span><span class="nc">URL</span><span class="o">(</span><span class="s">&quot;https://gist.github.com/Atry/89ee1baa4c161b8ccc1b82cdd9c109fe/raw/d39cec0483a78a514342b16567aebebe0f890d38/Adagrad.sc&quot;</span><span class="o">)).</span><span class="n">mkString</span><span class="o">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[11]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-scala"><pre><span></span><span class="n">interp</span><span class="o">.</span><span class="n">load</span><span class="o">(</span><span class="s">&quot;&quot;&quot;</span>
<span class="s">  val hyperparameters2 = Factory[Builtins with FixedLearningRate with Adagrad].newInstance(</span>
<span class="s">    learningRate = 0.002,</span>
<span class="s">    eps = 0.0001</span>
<span class="s">  )</span>
<span class="s">&quot;&quot;&quot;</span><span class="o">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[12]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-scala"><pre><span></span><span class="k">val</span> <span class="n">weight2</span> <span class="k">=</span> <span class="n">hyperparameters2</span><span class="o">.</span><span class="nc">INDArrayWeight</span><span class="o">(</span><span class="nc">Nd4j</span><span class="o">.</span><span class="n">randn</span><span class="o">(</span><span class="mi">10</span><span class="o">,</span> <span class="mi">10</span><span class="o">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[12]:</div>




<div class="output_text output_subarea output_execute_result">
<pre><span class="ansi-cyan-fg">weight2</span>: <span class="ansi-green-fg">Object</span> with <span class="ansi-green-fg">hyperparameters2</span>.<span class="ansi-green-fg">INDArrayWeightApi</span> with <span class="ansi-green-fg">hyperparameters2</span>.<span class="ansi-green-fg">WeightApi</span> with <span class="ansi-green-fg">hyperparameters2</span>.<span class="ansi-green-fg">WeightApi</span> with <span class="ansi-green-fg">hyperparameters2</span>.<span class="ansi-green-fg">INDArrayWeightApi</span> = Weight[fullName=$sess.cmd11Wrapper.Helper.weight2]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[13]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-scala"><pre><span></span><span class="k">def</span> <span class="n">layer2</span><span class="o">(</span><span class="n">input</span><span class="k">:</span> <span class="kt">hyperparameters1.INDArrayLayer</span><span class="o">)</span><span class="k">:</span> <span class="kt">hyperparameters2.INDArrayLayer</span> <span class="o">=</span> <span class="o">{</span>
  <span class="k">import</span> <span class="nn">hyperparameters2.implicits._</span>
  <span class="k">import</span> <span class="nn">hyperparameters2.max</span>
  <span class="k">import</span> <span class="nn">hyperparameters1.implicits.</span><span class="o">{</span><span class="n">layerDeepLearning</span> <span class="k">=&gt;</span> <span class="n">layerDeepLearning1</span><span class="o">}</span>
  <span class="n">max</span><span class="o">(</span><span class="n">layer1</span><span class="o">(</span><span class="n">input</span><span class="o">)</span> <span class="n">dot</span> <span class="n">weight2</span><span class="o">,</span> <span class="mf">0.0</span><span class="o">)</span>
<span class="o">}</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[13]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>defined <span class="ansi-green-fg">function</span> <span class="ansi-cyan-fg">layer2</span></pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[14]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-scala"><pre><span></span><span class="k">type</span> <span class="kt">INDArrayExpression</span><span class="o">[</span><span class="kt">Expression</span><span class="o">]</span> <span class="k">=</span> <span class="nc">DeepLearning</span><span class="o">[</span><span class="kt">Expression</span><span class="o">]</span> <span class="o">{</span>
  <span class="cm">/** The type of result calculated during forward pass */</span>
  <span class="k">type</span> <span class="kt">Data</span> <span class="o">=</span> <span class="nc">INDArray</span>

  <span class="cm">/** The type of derivative during backward pass */</span>
  <span class="k">type</span> <span class="kt">Delta</span> <span class="o">=</span> <span class="nc">INDArray</span>
<span class="o">}</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[14]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>defined <span class="ansi-green-fg">type</span> <span class="ansi-cyan-fg">INDArrayExpression</span></pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[15]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-scala"><pre><span></span><span class="k">def</span> <span class="n">polyLayer1</span><span class="o">[</span><span class="kt">Input:</span> <span class="kt">INDArrayExpression</span><span class="o">](</span><span class="n">input</span><span class="k">:</span> <span class="kt">Input</span><span class="o">)</span><span class="k">:</span> <span class="kt">hyperparameters1.INDArrayLayer</span> <span class="o">=</span> <span class="o">{</span>
  <span class="k">import</span> <span class="nn">hyperparameters1.implicits._</span>
  <span class="k">import</span> <span class="nn">hyperparameters1.max</span>
  <span class="n">max</span><span class="o">(</span><span class="n">input</span><span class="o">.</span><span class="n">dot</span><span class="o">(</span><span class="n">weight1</span><span class="o">),</span> <span class="mf">0.0</span><span class="o">)</span>
<span class="o">}</span>

<span class="k">def</span> <span class="n">polyLayer2</span><span class="o">[</span><span class="kt">Input:</span> <span class="kt">INDArrayExpression</span><span class="o">](</span><span class="n">input</span><span class="k">:</span> <span class="kt">Input</span><span class="o">)</span><span class="k">:</span> <span class="kt">hyperparameters2.INDArrayLayer</span> <span class="o">=</span> <span class="o">{</span>
  <span class="k">import</span> <span class="nn">hyperparameters2.implicits._</span>
  <span class="k">import</span> <span class="nn">hyperparameters2.max</span>  
  <span class="k">import</span> <span class="nn">hyperparameters1.implicits.</span><span class="o">{</span><span class="n">layerDeepLearning</span> <span class="k">=&gt;</span> <span class="n">layerDeepLearning1</span><span class="o">}</span>
  <span class="n">max</span><span class="o">(</span><span class="n">polyLayer1</span><span class="o">(</span><span class="n">input</span><span class="o">).</span><span class="n">dot</span><span class="o">(</span><span class="n">weight2</span><span class="o">),</span> <span class="mf">0.0</span><span class="o">)</span>
<span class="o">}</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[15]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>defined <span class="ansi-green-fg">function</span> <span class="ansi-cyan-fg">polyLayer1</span>
defined <span class="ansi-green-fg">function</span> <span class="ansi-cyan-fg">polyLayer2</span></pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-scala"><pre><span></span>
</pre></div>

    </div>
</div>
</div>

</div>

<p><a href="HeterogeneousHyperparameter.ipynb">Download this tutorial</a></p>

                        <div class="spacing"></div>
                    </div>
                </section>
            </div>

        </div>
    </div>
</div>


	<!-- Tweet -->
	<div id="tweet">
		<div class="container">
			<section>
				<blockquote>
					DeepLearning.scala is an open source deep-learning toolkit in Scala created by our colleagues at ThoughtWorks.
					We're excited about this project because it uses differentiable functional programming to create and compose neural networks; a developer simply writes code in Scala with static typing.
				</blockquote>
			</section>
		</div>
	</div>


<!-- Footer -->
<div id="footer">
	<div class="container">
		<section>
			<header>
				<h2>Get in touch</h2>
				<!-- <span class="byline">Integer sit amet pede vel arcu aliquet pretium</span> -->
			</header>
			<ul class="contact">
				<li><a href="https://github.com/ThoughtWorksInc/DeepLearning.scala" title="Github" class="fa fa-github"><span>Github</span></a></li>
				<li><a href="https://gitter.im/ThoughtWorksInc/DeepLearning.scala" title="Gitter" style="width: 20px; vertical-align: text-bottom">
					<svg
						version="1.1"
						xmlns="http://www.w3.org/2000/svg"
						xmlns:xlink="http://www.w3.org/1999/xlink"
						viewBox="0 0 14 20"
					>
						<rect x="12" y="4"width="2" height="8"/>
						<rect x="8" y="4" width="2" height="16"/>
						<rect x="4" y="4"width="2" height="16"/>
						<rect width="2" height="12"/>
					</svg>
					<span>Gitter</span>
				</a></li>
				<li><a href="mailto:tw-data-china@thoughtworks.com" title="Email" class="fa fa-envelope-o"><span>Email</span></a></li>
			</ul>
		</section>
	</div>
</div>

<!-- Copyright -->
<div id="copyright">
	<div class="container">
		© 2017 ThoughtWorks, Inc.
	</div>
</div>

</body>
</html>
